# 飞书批量下载工具

一个强大的 Chrome 浏览器扩展程序，用于批量下载飞书（Feishu/Lark）云文档中的文件。支持从"我的文件夹"和"共享文件夹"中批量获取文件，并以 ZIP 压缩包的形式下载到本地。

## ✨ 功能特性

- 📁 **批量文件获取**：自动获取飞书云文档中的所有文件（包括我的文件夹和共享文件夹）
- 🌳 **树形结构展示**：以清晰的树形结构展示文件和文件夹层级关系
- ✅ **多选下载**：支持选择多个文件进行批量下载
- 📦 **ZIP 压缩打包**：自动将所有选中的文件打包成 ZIP 压缩包
- 🎯 **智能去重**：自动识别并去除重复文件（优先保留共享文件夹中的源文件）
- 🎨 **现代化 UI**：美观的用户界面，支持拖拽移动面板
- 📄 **多文件类型支持**：支持文档、表格、幻灯片、思维笔记等多种文件类型
- ⚡ **异步下载**：采用异步下载机制，支持大文件下载
- 🔄 **实时进度显示**：显示下载进度和状态信息

## 📋 支持的文件类型

| 文件类型 | 导出格式 | 说明 |
|---------|----------|---------|
| 多维表 | .xlsx | 飞书多维表格 |
| 表格 | .xlsx | 飞书电子表格 |
| 幻灯片 | .pptx | 飞书演示文稿 |
| 文档 | .docx | 飞书文档 |
| 文档画板 | .docx | 飞书文档画板 |
| 思维笔记 | .mm | 飞书思维导图 |

## 🚀 安装步骤

### 方法一：从源码安装（推荐）

1. **克隆或下载项目**
   ```bash
   git clone https://github.com/lc0609/feishu-batch-download.git
   ```

2. **加载扩展程序**
   - 打开 Chrome 浏览器
   - 访问 `chrome://extensions/`
   - 开启右上角的"开发者模式"
   - 点击"加载已解压的扩展程序"
   - 选择项目文件夹

4. **验证安装**
   - 访问飞书网页版 https://www.feishu.cn
   - 进入云文档
   - 点击浏览器工具栏中的扩展图标
   - 应该能看到下载面板

## 📖 使用方法

### 基本使用流程

1. **打开飞书网页版**
   - 访问 https://www.feishu.cn
   - 确保已登录您的飞书账号
   - 进入云文档

2. **打开下载面板**
   - 点击浏览器工具栏中的扩展图标
   - 面板会在页面右上角显示

3. **获取文件列表**
   - 点击"获取所有文件"按钮
   - 等待系统自动获取所有文件和文件夹
   - 文件列表会以树形结构展示

4. **选择要下载的文件**
   - 勾选文件前的复选框来选择文件
   - 点击文件行也可以切换选择状态
   - 使用"全选"和"全不选"按钮快速操作
   - 点击文件夹可以展开/收起子文件夹

5. **下载文件**
   - 选择完文件后，点击"下载选中文件"按钮
   - 系统会自动下载所有选中的文件并打包成 ZIP
   - 下载完成后，ZIP 文件会自动保存到浏览器的默认下载目录

### 高级功能

- **拖拽面板**：点击面板标题栏可以拖拽移动面板位置
- **文件夹展开**：点击文件夹名称或展开图标可以展开/收起文件夹
- **文件路径保留**：下载的文件会保留原有的文件夹结构

## 🏗️ 项目结构

```
feishu-batch-download/
├── manifest.json          # Chrome 扩展配置文件
├── background.js          # 后台服务脚本（处理 Cookie 和消息传递）
├── content.js            # 内容脚本（注入到飞书页面，处理文件获取和下载）
├── panel.js              # 面板脚本（处理 UI 交互和文件打包）
├── popup.css             # 样式文件
├── jszip.min.js          # JSZip 库
├── FileSaver.min.js      # FileSaver库
├── icon.png              # 扩展图标
└── README.md             # 本文件
```

## 🔒 隐私和安全

- 本扩展仅在本地运行，不会上传任何数据到第三方服务器
- 所有文件下载都是通过飞书官方 API 进行的
- 扩展只访问飞书域名下的 Cookie，不会访问其他网站
- 源代码完全开源，可自行审查

## 📝 开发说明

### 本地开发

1. 克隆项目后，确保所有依赖文件已下载
2. 在 Chrome 中加载扩展（开发者模式）
3. 修改代码后，在 `chrome://extensions/` 页面点击"重新加载"按钮
4. 刷新飞书页面以应用更改

### 调试技巧

- 使用 `console.log` 输出调试信息
- 在 `chrome://extensions/` 中点击"检查视图"查看后台脚本日志
- 在飞书页面按 F12 打开开发者工具查看内容脚本日志

## 🤝 贡献

欢迎提交 Issue 和 Pull Request！


## 🙏 致谢

本项目在开发过程中借鉴了以下项目的代码和思路，特此致谢：

- **[feishu-doc-helper](https://github.com/sancijun/feishu-doc-helper)** - 飞书文档助手，感谢 [@sancijun](https://github.com/sancijun) 提供的飞书 API 调用思路和实现参考


**免责声明**：本工具仅供学习和个人使用。使用本工具下载的文件请遵守飞书的使用条款和相关法律法规。作者不对因使用本工具而产生的任何后果负责。

